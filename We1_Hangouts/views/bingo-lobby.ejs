<!-- views/bingo-lobby.ejs -->
<%- include('partials/header', { title: title }) %>

<div class="bingo-lobby-container">
    <div class="hero-section">
        <h1>üéØ BINGO Game Lobby</h1>
        <p>Play BINGO with up to 100 players in real-time!</p>
    </div>

    <div class="lobby-content">
        <!-- Create New Game Section -->
        <div class="create-game-section">
            <h2>üéÆ Create New BINGO Game</h2>
            
            <form id="create-bingo-form" class="create-form">
                <div class="form-group">
                    <label for="board-size">Board Size:</label>
                    <select id="board-size" name="boardSize" required>
                        <option value="small">Small (3√ó3) - Numbers 1-25</option>
                        <option value="medium" selected>Medium (5√ó5) - Numbers 1-75 (Classic)</option>
                        <option value="large">Large (7√ó7) - Numbers 1-100</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="max-players">Maximum Players:</label>
                    <input type="number" id="max-players" name="maxPlayers" min="2" max="100" value="100">
                    <small>Between 2 and 100 players</small>
                </div>

                <div class="form-group">
                    <label>
                        <input type="checkbox" id="auto-call" name="autoCall" value="true">
                        Enable Auto-Call (automatic number calling)
                    </label>
                </div>

                <button type="submit" class="btn-create-game">Create BINGO Room</button>
            </form>
        </div>

        <!-- Join Existing Game Section -->
        <div class="join-game-section">
            <h2>üö™ Join Existing Game</h2>
            
            <div class="join-form">
                <div class="form-group">
                    <label for="room-code">Room Code:</label>
                    <input type="text" id="room-code" placeholder="Enter room code (e.g., BINGO_ABC123)" maxlength="20">
                </div>
                
                <button id="join-room-btn" class="btn-join-room">Join Game</button>
            </div>
        </div>

        <!-- Quick Play Section -->
        <div class="quick-play-section">
            <h2>‚ö° Quick Play</h2>
            <p>Jump into a random BINGO game with default settings</p>
            
            <div class="quick-play-options">
                <button class="quick-play-btn" data-size="small">
                    <h3>Small (3√ó3)</h3>
                    <p>Fast games, 1-25 numbers</p>
                </button>
                
                <button class="quick-play-btn" data-size="medium">
                    <h3>Classic (5√ó5)</h3>
                    <p>Traditional BINGO, 1-75 numbers</p>
                </button>
                
                <button class="quick-play-btn" data-size="large">
                    <h3>Large (7√ó7)</h3>
                    <p>Extended games, 1-100 numbers</p>
                </button>
            </div>
        </div>

        <!-- Game Features Section -->
        <div class="features-section">
            <h2>üåü BINGO Game Features</h2>
            
            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">üë•</div>
                    <h3>Multiplayer</h3>
                    <p>Play with up to 100 players simultaneously</p>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">üìè</div>
                    <h3>Multiple Board Sizes</h3>
                    <p>Choose from 3√ó3, 5√ó5, or 7√ó7 grids</p>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">ü§ñ</div>
                    <h3>Auto-Call Mode</h3>
                    <p>Automatic number calling or manual control</p>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">üèÜ</div>
                    <h3>Multiple Winners</h3>
                    <p>Support for multiple winners per game</p>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">üí¨</div>
                    <h3>Live Chat</h3>
                    <p>Chat with other players during the game</p>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">üìä</div>
                    <h3>Real-time Stats</h3>
                    <p>Track game progress and player statistics</p>
                </div>
            </div>
        </div>

        <!-- How to Play Section -->
        <div class="how-to-play-section">
            <h2>üìñ How to Play</h2>
            
            <div class="instructions">
                <div class="instruction-step">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <h3>Join or Create a Room</h3>
                        <p>Create a new BINGO room with your preferred settings or join an existing one using a room code.</p>
                    </div>
                </div>
                
                <div class="instruction-step">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <h3>Get Your Board</h3>
                        <p>Each player gets a unique BINGO board with random numbers. The center cell is FREE in 5√ó5 and 7√ó7 boards.</p>
                    </div>
                </div>
                
                <div class="instruction-step">
                    <div class="step-number">3</div>
                    <div class="step-content">
                        <h3>Number Calling</h3>
                        <p>The designated caller calls out numbers. When your board has a called number, it gets marked automatically.</p>
                    </div>
                </div>
                
                <div class="instruction-step">
                    <div class="step-number">4</div>
                    <div class="step-content">
                        <h3>Achieve BINGO</h3>
                        <p>Get BINGO by completing a row, column, diagonal, or full house (depending on game settings).</p>
                    </div>
                </div>
                
                <div class="instruction-step">
                    <div class="step-number">5</div>
                    <div class="step-content">
                        <h3>Multiple Winners</h3>
                        <p>Multiple players can win in the same game! The game continues until someone gets a full house or the caller stops.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Create game form handler
    const createForm = document.getElementById('create-bingo-form');
    createForm.addEventListener('submit', function(e) {
        e.preventDefault();
        
        const formData = new FormData(createForm);
        const gameData = {
            boardSize: formData.get('boardSize'),
            maxPlayers: formData.get('maxPlayers'),
            autoCall: formData.get('autoCall') === 'true'
        };
        
        fetch('/games/bingo/create', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(gameData)
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                window.location.href = data.gameUrl;
            } else {
                alert('Failed to create room: ' + data.message);
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('Failed to create room');
        });
    });
    
    // Join room handler
    const joinBtn = document.getElementById('join-room-btn');
    const roomCodeInput = document.getElementById('room-code');
    
    joinBtn.addEventListener('click', function() {
        const roomCode = roomCodeInput.value.trim().toUpperCase();
        if (roomCode) {
            window.location.href = `/games/bingo/${roomCode}`;
        } else {
            alert('Please enter a room code');
        }
    });
    
    roomCodeInput.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
            joinBtn.click();
        }
    });
    
    // Quick play handlers
    document.querySelectorAll('.quick-play-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            const boardSize = this.getAttribute('data-size');
            const roomId = 'BINGO_' + Math.random().toString(36).substr(2, 9).toUpperCase();
            window.location.href = `/games/bingo/${roomId}?size=${boardSize}`;
        });
    });
});
</script>
